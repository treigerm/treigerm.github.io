<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/basic.css"> <link rel=icon  href="/assets/favicon.ico"> <title>MCMC Diagnostics</title> <div class=franklin-content ><h1 id=mcmc_diagnostics ><a href="#mcmc_diagnostics" class=header-anchor >MCMC Diagnostics</a></h1> <p>MCMC gives asymptotic guarantees for producing samples from a target distribution. However, we do not have time to wait until forever and only run MCMC chains for a finite amount of time. Therefore we need diagnostics to tell us how reliable our estimates based on the MCMC samples are. Modern computers allow us to run MCMC on very high-dimensional problems which makes it infeasible to solely rely on visual diagnostics such as traceplots &#40;although they are still important&#41;.</p> <p>General MCMC diagnostics:</p> <ul> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>R</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{R}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.9467699999999999em;vertical-align:0em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9467699999999999em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span><span style="top:-3.25233em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >^</span></span></span></span></span></span></span></span></span></span></p> <ul> <li><p>This should only be trusted if the ESS &gt; 400 because it depends on estimates of the variance and autocorrelation</p> <li><p>We are finding two estimators for <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>a</mi><mi>r</mi><mo stretchy=false >(</mo><mi>θ</mi><mi mathvariant=normal >∣</mi><mi>y</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">var(\theta | y)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class=mord >∣</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class=mclose >)</span></span></span></span> which ideally should agree with each other but one estimator consistently overestimates and the other consistently underestimates. By taking the ratio of the two we get a sense of the lack of convergence.</p> </ul> <li><p>the effective sample size &#40;ESS&#41;</p> <li><p>Monte Carlo Squared Error &#40;MCSE&#41;</p> <li><p>Bulk- and tail-ESS</p> </ul> <p>ESS and MCSE estimates are for evaluating the posterior mean only&#33; But can be adapted </p> <p>Open questions:</p> <ul> <li><p>What is r-hat on a high level?</p> <li><p>How do we calculate ESS and MCSE?</p> </ul> <p>Dynamic HMC specific diagnostics:</p> <ul> <li><p>Estimated Bayesian fraction of missing information</p> <li><p>Divergences</p> <ul> <li><p>Link to divergences case studies of betancourt</p> </ul> </ul> <p>Resources to link to:</p> <ul> <li><p>Stan warning page</p> <li><p>Bayesplot vignettes</p> <li><p>Vehtari paper</p> <li><p>Betancourt paper</p> </ul> <h2 id=open_questions ><a href="#open_questions" class=header-anchor >Open questions</a></h2> <ul> <li><p>What are the &quot;default&quot; plots one should do after running inference? ArViZ and bayesplot provide a gazillion different plotting options so it is a bit overwhelming to understand what we are looking for</p> <ul> <li><p>Can the advice be worked into a decision tree which can potentially be automated?</p> <li><p>I guess partly it depends on what problem you are trying to solve and what parameters one is interested in.</p> </ul> </ul> <div class=page-foot > <div class=copyright > &copy; Tim Reichelt. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>. </div> </div> </div>